<h1 class="title">Create a Custom Widget Plugin</h1>

<p>
    Widgetkit is very modular and extendable by design, you can easily add your own widget plugin. To do so, you could copy an existing one and start adapting it to your needs or create a new one from scratch following this simple tutorial. You can find the inbuilt plugins in the <code>/wp-content/plugins/widgetkit/plugins/widgets</code> in WordPress and <code>/administrator/components/com_widgetkit/plugins/widgets</code> folder in Joomla.

    <span class="badge">NOTE</span> For guidance about where to store your customizations, please check out {doc: where-to-store-your-customizations text:this} doc.
</p>

<h2>File structure</h2>

<pre><code>
|-- plugin.php          // main plugin content
|-- widget.svg          // plugin icon in SVG format
+-- views/
|      edit.php         // edit form layout
|      widget.php       // widget form layout
</code></pre>

<h2>plugin.php</h2>

<p>
    The <code>plugin.php</code> file contains a PHP array to set your plugin by passing the configurations and event functions to Widgetkit.
</p>

<pre><code>
&lt;?php

array(

    // main Class the plugin is extending
    'main' => 'YOOtheme\\Widgetkit\\Widget\\Widget',

    // plugin configuration
    'config' => function($app) {

        return array(

            // plugin raw name
            'name'  => 'PLUGIN-NAME',

            // plugin label which will be displayed to the user
            'label' => 'PLUGIN-LABEL',

            // url to the icon that will be used in the widget plugin overview
            'icon'  => $app['url']->to('plugins/widgets/PLUGIN-NAME/widget.svg'),

            // path to the view file that will be used when rendering the widget
            'view'  => 'plugins/widgets/PLUGIN-NAME/views/widget.php',

            // supported widget fields
            // a list of fields the widget requires from a selected content element. Example: The map requires a 'location' field to be present.
            'item'  => array('title', 'content'),

            // default settings to be used for every widget instance
            'settings'  => array(
                'key' => 'value
            )
        );
    },

    // an array of Widgetkit events you can hook into
    'events' => array(

        // triggered when Widgetkit is initialized in the back end
        'init.admin' => function($event, $app) {

            // registers the edit view
            $app['angular']->addTemplate('PLUGIN-NAME.edit', 'plugins/widgets/PLUGIN-NAME/views/edit.php', true);
        },

        // triggered when Widgetkit is initialized in the front end
        'init.site' => function($event, $app) {},

        // triggered when Widgetkit is initialized
        'init' => function($event, $app) {}
    )

);
</code></pre>

<h2>views/edit.php</h2>

<p>
    The <code>view/edit.php</code> file contains the form layout that will be displayed when setting up the Widget rendering options. It relies on UIkit for its styling and on AngularJS for the logic for which you can check each respective documentation for further information.
</p>

<pre><code>

&lt;!-- wrapp the content with uk-form and uk-grid styles --&gt;
&lt;div class="uk-grid uk-grid-divider uk-form uk-form-horizontal" data-uk-grid-margin&gt;

    &lt;!-- set the left column --&gt;
    &lt;div class="uk-width-medium-1-4"&gt;

        &lt;!-- set the wk specific style --&gt;
        &lt;div class="wk-panel-marginless"&gt;

            &lt;!-- set the navigation connecting it to the uk-switcher --&gt;
            &lt;ul class="uk-nav uk-nav-side" data-uk-switcher="{connect:'#nav-content'}"&gt;
                &lt;li&gt;&lt;a href=""&gt;General&lt;/a&gt;&lt;/li&gt;
                &lt;li&gt;&lt;/li&gt;
                &lt;!-- keep adding them as you need --&gt;
            &lt;/ul&gt;
        &lt;/div&gt;

    &lt;/div&gt;

    &lt;!-- set the right column --&gt;
    &lt;div class="uk-width-medium-3-4"&gt;

        &lt;!-- set the uk-switcher content --&gt;
        &lt;ul id="nav-content" class="uk-switcher"&gt;

            &lt;!-- general switcher section content --&gt;
            &lt;li&gt;
                &lt;div class="uk-form-row"&gt;
                    &lt;label class="uk-form-FIELD-NAME" for="wk-columns"&gt;FIELD-LABEL&lt;/label&gt;
                    &lt;div class="uk-form-controls"&gt;
                        &lt;select id="wk-FIELD-NAME" class="uk-form-width-medium" ng-model="widget.data['FIELD-NAME']"&gt;
                            &lt;option value="1"&gt;1&lt;/option&gt;
                            &lt;option value="2"&gt;2&lt;/option&gt;
                        &lt;/select&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/li&gt;

            &lt;li&gt;&lt;/li&gt;
            &lt;!-- keep adding one for each section you have set --&gt;

        &lt;/ul&gt;

    &lt;/div&gt;
&lt;/div&gt;

</code></pre>

<h2>views/widget.php</h2>

<p>
    This is the layout that will be used when rendering the widget in the front end, is where all the rendering content and render settings are analyzed and converted into the HTML your browser expects.
</p>

<p>
    There is so much you can learn by just looking into the inbuild Widgets files, but as a quick reference those are the available variables.
</p>

<table class="zebra">
    <thead>
        <tr>
          <th>Variable</th>
          <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><em>$settings</em></td>
            <td>Array of the rendering settings</td>
        </tr>
        <tr>
            <td><em>$items</em></td>
            <td>An array of the Widget Items being rendered provided by the Content Provider</td>
        </tr>
    </tbody>
</table>

<p>
    <span class="badge">NOTE</span> When iterating over the $items you can access the custom fields by its key, which you would have speficied while setting the content provider. Eg: $item['customkey'].
</p>
